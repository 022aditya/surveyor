#surveyor
  - form_tag(update_my_survey_path, :method => :put, :id => "survey_form") do
    - unless @survey.sections.size < 3
      #menu
        Sections:
        %ul
          - @survey.sections.each do |s|
            %li{:class => ("active" if s == @section)}= menu_button_for(s)
    #header
      .title= @survey.title
    .previous_section= previous_section
    - unless @dependents.empty?
      #dependents
        .title Follow-up questions from your answers on the previous page
        - @dependents.each_with_index do |question, index|
          = dependency_explanation_helper(question, @response_set)
          = render(:partial => "/partials/question", :locals => {:question => question, :response_set => @response_set, :number => "D#{index+1}"})
    - div_for @section do
      %span.title= @section.title
      .questions
        - @section.questions.each_with_index do |question, index|
          - if question.part_of_group?
            - if (index + 1 >= @section.questions.size) or (question.question_group_id != @section.questions[index + 1].question_group_id)
              - # skip to the last question of the section, or the last question of the group
              = render(:partial => "/partials/question_group", :locals => {:question_group => question.question_group, :response_set => @response_set})
          - else
            = render(:partial => "/partials/question", :locals => {:question => question, :response_set => @response_set})
    .next_section= next_section
      